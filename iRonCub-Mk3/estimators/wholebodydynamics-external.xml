<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE devices PUBLIC "-//YARP//DTD yarprobotinterface 3.0//EN" "http://www.yarp.it/DTD/yarprobotinterfaceV3.0.dtd">

<devices robot="@WBD_YARP_ROBOT_NAME@" build="1">
    <device name="secondaryCalibration_l_arm_ft" type="ftSecondaryCalibImpl">
        <param name="period">      0.002      </param> <!-- in seconds-->
        <param name="sensorName">  l_arm_ft  </param>
        <xi:include href="./ft_secondary_calibration_models/leftArm_ft_models/3rd_degree.xml" />

        <action phase="startup" level="6" type="attach">
            <paramlist name="networks">
                <!-- ft -->
                <elem name="l_arm_jetpack_ft_sensors">left_arm_client</elem> <!-- left_arm, left_jetpack -->
            </paramlist>
        </action>
        <action phase="shutdown" level="2" type="detach" />
    </device>

    <device name="secondaryCalibration_r_arm_ft" type="ftSecondaryCalibImpl">
        <param name="period">      0.002      </param> <!-- in seconds-->
        <param name="sensorName">  r_arm_ft  </param>
        <xi:include href="./ft_secondary_calibration_models/dummy_ft_models/4th_order_dummy.xml" />

        <action phase="startup" level="6" type="attach">
            <paramlist name="networks">
                <!-- ft -->
                <elem name="r_arm_jetpack_ft_sensors">right_arm_client</elem> <!-- right_arm, right_jetpack -->
            </paramlist>
        </action>
        <action phase="shutdown" level="2" type="detach" />
    </device>

    <device name="secondaryCalibration_l_jet_ft" type="ftSecondaryCalibImpl">
        <param name="period">      0.002      </param> <!-- in seconds-->
        <param name="sensorName">  l_jet_ft  </param>
        <xi:include href="./ft_secondary_calibration_models/dummy_ft_models/4th_order_dummy.xml" />

        <action phase="startup" level="6" type="attach">
            <paramlist name="networks">
                <!-- ft -->
                <elem name="l_arm_jetpack_ft_sensors">left_arm_client</elem> <!-- left_arm, left_jetpack -->
            </paramlist>
        </action>
        <action phase="shutdown" level="2" type="detach" />
    </device>

    <device name="secondaryCalibration_r_jet_ft" type="ftSecondaryCalibImpl">
        <param name="period">      0.002      </param> <!-- in seconds-->
        <param name="sensorName">  r_jet_ft  </param>
        <xi:include href="./ft_secondary_calibration_models/dummy_ft_models/4th_order_dummy.xml" />

        <action phase="startup" level="6" type="attach">
            <paramlist name="networks">
                <!-- ft -->
                <elem name="r_arm_jetpack_ft_sensors">right_arm_client</elem> <!-- right_arm, right_jetpack -->
            </paramlist>
        </action>
        <action phase="shutdown" level="2" type="detach" />
    </device>

    <device name="secondaryCalibration_l_foot_front_ft" type="ftSecondaryCalibImpl">
        <param name="period">      0.002      </param> <!-- in seconds-->
        <param name="sensorName">  l_foot_front_ft  </param>
        <xi:include href="./ft_secondary_calibration_models/dummy_ft_models/1st_order_dummy.xml" />

        <action phase="startup" level="6" type="attach">
            <paramlist name="networks">
                <!-- ft -->
                <elem name="l_foot_ft_sensors">left_foot_client</elem> <!-- left_foot_front, left_foot_rear -->
            </paramlist>
        </action>
        <action phase="shutdown" level="2" type="detach" />
    </device>

    <device name="secondaryCalibration_r_foot_front_ft" type="ftSecondaryCalibImpl">
        <param name="period">      0.002      </param> <!-- in seconds-->
        <param name="sensorName">  r_foot_front_ft  </param>
        <xi:include href="./ft_secondary_calibration_models/dummy_ft_models/1st_order_dummy.xml" />

        <action phase="startup" level="6" type="attach">
            <paramlist name="networks">
                <!-- ft -->
                <elem name="r_foot_ft_sensors">right_foot_client</elem> <!-- right_foot_front, right_foot_rear -->
            </paramlist>
        </action>
        <action phase="shutdown" level="2" type="detach" />
    </device>

    <device name="secondaryCalibration_l_foot_rear_ft" type="ftSecondaryCalibImpl">
        <param name="period">      0.002      </param> <!-- in seconds-->
        <param name="sensorName">  l_foot_rear_ft  </param>
        <xi:include href="./ft_secondary_calibration_models/dummy_ft_models/1st_order_dummy.xml" />

        <action phase="startup" level="6" type="attach">
            <paramlist name="networks">
                <!-- ft -->
                <elem name="l_foot_ft_sensors">left_foot_client</elem> <!-- left_foot_front, left_foot_rear -->
            </paramlist>
        </action>
        <action phase="shutdown" level="2" type="detach" />
    </device>

    <device name="secondaryCalibration_r_foot_rear_ft" type="ftSecondaryCalibImpl">
        <param name="period">      0.002      </param> <!-- in seconds-->
        <param name="sensorName">  r_foot_rear_ft  </param>
        <xi:include href="./ft_secondary_calibration_models/dummy_ft_models/1st_order_dummy.xml" />

        <action phase="startup" level="6" type="attach">
            <paramlist name="networks">
                <!-- ft -->
                <elem name="r_foot_ft_sensors">right_foot_client</elem> <!-- right_foot_front, right_foot_rear -->
            </paramlist>
        </action>
        <action phase="shutdown" level="2" type="detach" />
    </device>

    <device name="wholebodydynamics" type="wholebodydynamics">
        <param name="axesNames">(torso_pitch,torso_roll,torso_yaw,neck_pitch, neck_roll,neck_yaw,l_shoulder_pitch,l_shoulder_roll,l_shoulder_yaw,l_elbow,r_shoulder_pitch,r_shoulder_roll,r_shoulder_yaw,r_elbow,l_hip_pitch,l_hip_roll,l_hip_yaw,l_knee,l_ankle_pitch,l_ankle_roll,r_hip_pitch,r_hip_roll,r_hip_yaw,r_knee,r_ankle_pitch,r_ankle_roll)</param>
        <param name="modelFile">model.urdf</param>
        <param name="fixedFrameGravity">(0,0,-9.81)</param>
        <param name="defaultContactFrames">(l_elbow_1,chest_l_jet_turbine,chest_r_jet_turbine,r_elbow_1,root_link,l_sole,r_sole,l_ankle_1,r_ankle_1,l_foot_front,r_foot_front)</param>
        <param name="overrideContactFrames">(l_arm_jet_turbine, r_arm_jet_turbine, chest_l_jet_turbine, chest_r_jet_turbine, root_link, l_foot_rear, r_foot_rear, l_foot_front, r_foot_front)</param>
        <param name="contactWrenchType">(    pure             , pure             , pure               , pure               , full     , full     , full     , full        , full         )</param>
        <param name="contactWrenchDirection">(0,0,1           , 0,0,1            , 0,0,1              , 0,0,1              , 0,0,0    , 0,0,0    ,0,0,0     , 0,0,0       , 0,0,0        )</param>
        <param name="contactWrenchPosition">( 0,0,0           , 0,0,0            , 0,0,0              , 0,0,0              , 0,0,0    , 0,0,0    ,0,0,0     , 0,0,0       , 0,0,0        )</param>
        <param name="imuFrameName">chest_imu</param>
        <param name="forceTorqueEstimateConfidence">2</param>
        <param name="useJointVelocity">true</param>
        <param name="useJointAcceleration">false</param>
        <param name="streamFilteredFT">true</param>
        <param name="imuFilterCutoffInHz">3.0</param>
        <param name="forceTorqueFilterCutoffInHz">2.0</param>
        <param name="jointVelFilterCutoffInHz">3.0</param> <!-- used if useJointVelocity is set to true -->
        <param name="jointAccFilterCutoffInHz">3.0</param> <!-- used if useJointAcceleration is set to true -->
        <param name="startWithZeroFTSensorOffsets">true</param> <!-- bypass using resetOffset of FT sensors in simulation -->
        <param name="useSkinForContacts">false</param>
        <param name="additionalConsideredFixedJoints">(l_elbow_turbine, r_elbow_turbine, l_jet_ft_sensor, r_jet_ft_sensor, jetpack)</param> <!-- Added explicitly in order to be found by WBD_OUTPUT_EXTERNAL_WRENCH_PORTS since they are attached to fixed joints -->
        <param name="devicePeriodInSeconds">0.002</param>
        <param name="estimateJointVelocityAcceleration">false</param>  <!-- if true a kf will estimate the joint velocities and accelerations -->
        <param name="processNoiseCovariance">(1.0e-3, 1.0e-3, 1.0e-3,
                                              1.0e-3, 1.0e-3, 1.0e-3,
                                              1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3,
                                              1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3,
                                              1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3,
                                              1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3,
                                              1.0e-3, 1.0e-3, 1.0e-3,
                                              1.0e-3, 1.0e-3, 1.0e-3,
                                              1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3,
                                              1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3,
                                              1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3,
                                              1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3,
                                              1.0e+1, 1.0e+1, 1.0e+1,
                                              1.0e+1, 1.0e+1, 1.0e+1,
                                              1.0e+1, 1.0e+1, 1.0e+1, 1.0e+1,
                                              1.0e+1, 1.0e+1, 1.0e+1, 1.0e+1,
                                              1.0e+1, 1.0e+1, 1.0e+1, 1.0e+1, 1.0e+1, 1.0e+1,
                                              1.0e+1, 1.0e+1, 1.0e+1, 1.0e+1, 1.0e+1, 1.0e+1)</param>
        <param name="measurementNoiseCovariance">(1.0e-3, 1.0e-3, 1.0e-3,
                                                  1.0e-3, 1.0e-3, 1.0e-3,
                                                  1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3,
                                                  1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3,
                                                  1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3,
                                                  1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3)</param>
        <param name="stateCovariance">(5.0e-4, 5.0e-4, 5.0e-4,
                                       5.0e-4, 5.0e-4, 5.0e-4,
                                       5.0e-4, 5.0e-4, 5.0e-4, 5.0e-4,
                                       5.0e-4, 5.0e-4, 5.0e-4, 5.0e-4,
                                       5.0e-4, 5.0e-4, 5.0e-4, 5.0e-4, 5.0e-4, 5.0e-4,
                                       5.0e-4, 5.0e-4, 5.0e-4, 5.0e-4, 5.0e-4, 5.0e-4,
                                       1.0e-3, 1.0e-3, 1.0e-3,
                                       1.0e-3, 1.0e-3, 1.0e-3,
                                       1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3,
                                       1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3,
                                       1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3,
                                       1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3, 1.0e-3,
                                       1.0e-1, 1.0e-1, 1.0e-1,
                                       1.0e-1, 1.0e-1, 1.0e-1,
                                       1.0e-1, 1.0e-1, 1.0e-1, 1.0e-1,
                                       1.0e-1, 1.0e-1, 1.0e-1, 1.0e-1,
                                       1.0e-1, 1.0e-1, 1.0e-1, 1.0e-1, 1.0e-1, 1.0e-1,
                                       1.0e-1, 1.0e-1, 1.0e-1, 1.0e-1, 1.0e-1, 1.0e-1)</param>

        <!--        <param name="assume_fixed">root_link</param>-->
        <group name="HW_USE_MAS_IMU">
            <param name="accelerometer">sensor_imu_xsensmt</param>
            <param name="gyroscope">sensor_imu_xsensmt</param>
        </group>

        <group name="GRAVITY_COMPENSATION">
            <param name="enableGravityCompensation">true</param>
            <param name="gravityCompensationBaseLink">root_link</param>
            <param name="gravityCompensationAxesNames">(torso_roll,torso_pitch,torso_yaw,neck_pitch,neck_roll,neck_yaw,l_shoulder_pitch,l_shoulder_roll,l_shoulder_yaw,l_elbow,r_shoulder_pitch,r_shoulder_roll,r_shoulder_yaw,r_elbow,l_hip_pitch,l_hip_roll,l_hip_yaw,l_knee,l_ankle_pitch,l_ankle_roll,r_hip_pitch,r_hip_roll,r_hip_yaw,r_knee,r_ankle_pitch,r_ankle_roll)</param>
        </group>

        <group name="WBD_OUTPUT_EXTERNAL_WRENCH_PORTS">
            <param name="/wholeBodyDynamics-external/left_arm_thrust/cartesianEndEffectorWrench:o">(l_arm_jet_turbine, l_arm_jet_turbine)</param>
            <param name="/wholeBodyDynamics-external/right_arm_thrust/cartesianEndEffectorWrench:o">(r_arm_jet_turbine, r_arm_jet_turbine)</param>
            <param name="/wholeBodyDynamics-external/left_jet_thrust/cartesianEndEffectorWrench:o">(chest_l_jet_turbine, chest_l_jet_turbine)</param>
            <param name="/wholeBodyDynamics-external/right_jet_thrust/cartesianEndEffectorWrench:o">(chest_r_jet_turbine, chest_r_jet_turbine)</param>
            <param name="/wholeBodyDynamics-external/left_foot_front/cartesianEndEffectorWrench:o">(l_foot_front, l_sole, l_sole)</param>
            <param name="/wholeBodyDynamics-external/left_foot_rear/cartesianEndEffectorWrench:o">(l_foot_rear, l_sole, l_sole)</param>
            <param name="/wholeBodyDynamics-external/right_foot_front/cartesianEndEffectorWrench:o">(r_foot_front, r_sole, r_sole)</param>
            <param name="/wholeBodyDynamics-external/right_foot_rear/cartesianEndEffectorWrench:o">(r_foot_rear, r_sole, r_sole)</param>
        </group>

         <group name="multipleAnalogSensorsNames">
            <param name="SixAxisForceTorqueSensorsNames">("l_arm_ft", "r_arm_ft", "l_jet_ft", "r_jet_ft", "l_foot_front_ft", "r_foot_front_ft", "l_foot_rear_ft", "r_foot_rear_ft")</param>
            <!-- <param name="TemperatureSensorsNames">("l_arm_ft", "r_arm_ft", "l_jet_ft", "r_jet_ft", "l_foot_front_ft", "r_foot_front_ft", "l_foot_rear_ft", "r_foot_rear_ft")</param> -->
        </group>


        <action phase="startup" level="15" type="attach">
            <paramlist name="networks">

                <elem name="head_mc">head_mc</elem>
                <elem name="torso_mc">torso_mc</elem>
                <elem name="left_arm_mc">left_arm_mc</elem>
                <elem name="right_arm_mc">right_arm_mc</elem>
                <elem name="left_leg_mc">left_leg_mc</elem>
                <elem name="right_leg_mc">right_leg_mc</elem>

                <!-- imu -->
                <elem name="imu">head-inertial-client</elem>
                <!-- imu_waist -->
<!--            <elem name="imu">xsensmt-inertial</elem> -->
                <!-- ft -->
                <elem name="l_arm_ft_sensor">secondaryCalibration_l_arm_ft</elem>
                <elem name="r_arm_ft_sensor">secondaryCalibration_r_arm_ft</elem>
                <elem name="l_jet_sensor">secondaryCalibration_l_jet_ft</elem>
                <elem name="r_jet_sensor">secondaryCalibration_r_jet_ft</elem>

                <elem name="l_foot_front_sensor">secondaryCalibration_l_foot_front_ft</elem> <!-- left_front -->
                <elem name="r_foot_front_sensor">secondaryCalibration_r_foot_front_ft</elem> <!-- right_front -->
                <elem name="l_foot_rear_sensor">secondaryCalibration_l_foot_rear_ft</elem> <!-- left_rear -->
                <elem name="r_foot_rear_sensor">secondaryCalibration_r_foot_rear_ft</elem> <!-- right_rear -->

            </paramlist>
        </action>

        <action phase="shutdown" level="2" type="detach" />

    </device>
</devices>

